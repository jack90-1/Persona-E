[
    {
        "name": "1.Level_Initiate",
        "trigger": "level_start",
        "level_nid": null,
        "condition": "\"Battle\" in game.level.tags",
        "commands": [],
        "only_once": false,
        "priority": 21,
        "_source": [
            "skip_save;t",
            "trigger_script_with_args;2.Get Party Units;state,alive",
            "for;party_unit;[u for u in {v:all_playable_units}]",
            "    if;game.game_vars.get(u('{party_unit}').nid + '_hp')",
            "        set_current_hp;{party_unit};{e:game.game_vars.get(u('{party_unit}').nid + '_hp')}",
            "    end",
            "endf",
            "for;DeadGuys;[u for u in game.get_units_in_party('DeadGuys')]",
            "    change_party;{DeadGuys};Exploration_Team",
            "    set_current_hp;{DeadGuys};1",
            "endf",
            "for;enemy_unit;[u for u in game.level.units if u.team in ['enemy', 'enemy2']]",
            "    give_skill;{enemy_unit};mapcirclepurple;no_banner",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Mage'",
            "        change_affinity;{enemy_unit};Magician",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Pegasus_Knight'",
            "        change_affinity;{enemy_unit};Priestess",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Eagle_Knight'",
            "        change_affinity;{enemy_unit};Empress",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Armor'",
            "        change_affinity;{enemy_unit};Emperor",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Cleric'",
            "        change_affinity;{enemy_unit};Hierophant",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Troubador'",
            "        change_affinity;{enemy_unit};Lovers",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Fighter'",
            "        change_affinity;{enemy_unit};Chariot",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Cavalier'",
            "        change_affinity;{enemy_unit};Justice",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Myrmidon'",
            "        change_affinity;{enemy_unit};Hermit",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Mercenary'",
            "        change_affinity;{enemy_unit};Fortune",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Wyvern_Knight'",
            "        change_affinity;{enemy_unit};Strength",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Thief'",
            "        change_affinity;{enemy_unit};Hanged",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Gunman'",
            "        change_affinity;{enemy_unit};Death",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Archer'",
            "        change_affinity;{enemy_unit};Temperance",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Brigand'",
            "        change_affinity;{enemy_unit};Devil",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Soldier' and 'Boss' not in game.get_unit(\"{enemy_unit}\").tags",
            "        change_affinity;{enemy_unit};Tower",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Flagbearer'",
            "        change_affinity;{enemy_unit};Star",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Shaman'",
            "        change_affinity;{enemy_unit};Moon",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Monk'",
            "        change_affinity;{enemy_unit};Sun",
            "    end",
            "    if;game.get_unit(\"{enemy_unit}\").klass == 'Master_Knight'",
            "        change_affinity;{enemy_unit};Judgement",
            "    end",
            "endf",
            "for;other_unit;[u for u in game.level.units if u.team in ['other']]",
            "    give_skill;{other_unit};mapcirclegreen;no_banner",
            "endf"
        ],
        "nid": "Global 1.Level_Initiate"
    }
]